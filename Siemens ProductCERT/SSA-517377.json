{
  "document": {
    "category": "csaf_security_advisory",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Disclosure is not limited. (TLPv2: TLP:CLEAR)",
      "tlp": {
        "label": "WHITE"
      }
    },
    "notes": [
      {
        "category": "summary",
        "text": "The below referenced devices contain multiple vulnerabilities that could be exploited when the SINEMA Remote Connect Server (SRCS) VPN feature is used. The feature is not activated by default. The most severe could allow an attacker to execute arbitrary code with elevated privileges under certain circumstances.\n\nSiemens has released updates for the affected products and recommends to update to the latest versions.",
        "title": "Summary"
      },
      {
        "category": "general",
        "text": "As a general security measure, Siemens strongly recommends to protect network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends to configure the environment according to Siemens' operational guidelines for Industrial Security (Download: \nhttps://www.siemens.com/cert/operational-guidelines-industrial-security), and to follow the recommendations in the product manuals.\nAdditional information on Industrial Security by Siemens can be found at: https://www.siemens.com/industrialsecurity",
        "title": "General Recommendations"
      },
      {
        "category": "general",
        "text": "For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the Siemens ProductCERT: https://www.siemens.com/cert/advisories",
        "title": "Additional Resources"
      },
      {
        "category": "legal_disclaimer",
        "text": "Siemens Security Advisories are subject to the terms and conditions contained in Siemens' underlying license terms or other applicable agreements previously agreed to with Siemens (hereinafter \"License Terms\"). To the extent applicable to information, software or documentation made available in or through a Siemens Security Advisory, the Terms of Use of Siemens' Global Website (https://www.siemens.com/terms_of_use, hereinafter \"Terms of Use\"), in particular Sections 8-10 of the Terms of Use, shall apply additionally. In case of conflicts, the License Terms shall prevail over the Terms of Use.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "productcert@siemens.com",
      "name": "Siemens ProductCERT",
      "namespace": "https://www.siemens.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "SSA-517377: Multiple Vulnerabilities in the SRCS VPN Feature in SIMATIC CP Devices - PDF Version",
        "url": "https://cert-portal.siemens.com/productcert/pdf/ssa-517377.pdf"
      },
      {
        "category": "self",
        "summary": "SSA-517377: Multiple Vulnerabilities in the SRCS VPN Feature in SIMATIC CP Devices - TXT Version",
        "url": "https://cert-portal.siemens.com/productcert/txt/ssa-517377.txt"
      },
      {
        "category": "self",
        "summary": "SSA-517377: Multiple Vulnerabilities in the SRCS VPN Feature in SIMATIC CP Devices - CSAF Version",
        "url": "https://cert-portal.siemens.com/productcert/csaf/ssa-517377.json"
      }
    ],
    "title": "SSA-517377: Multiple Vulnerabilities in the SRCS VPN Feature in SIMATIC CP Devices",
    "tracking": {
      "current_release_date": "2023-03-14T00:00:00Z",
      "generator": {
        "engine": {
          "name": "Siemens ProductCERT CSAF Generator",
          "version": "1"
        }
      },
      "id": "SSA-517377",
      "initial_release_date": "2022-07-12T00:00:00Z",
      "revision_history": [
        {
          "date": "2022-07-12T00:00:00Z",
          "legacy_version": "1.0",
          "number": "1",
          "summary": "Publication Date"
        },
        {
          "date": "2022-08-09T00:00:00Z",
          "legacy_version": "1.1",
          "number": "2",
          "summary": "Added fix for SIMATIC CP 1242-7 V2, CP 1243-7, CP 1243-1, CP 1243-8"
        },
        {
          "date": "2023-03-14T00:00:00Z",
          "legacy_version": "1.2",
          "number": "3",
          "summary": "Added fix for SIMATIC CP 1542SP-1 IRC, and SIMATIC CP 1543SP-1"
        }
      ],
      "status": "interim",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIMATIC CP 1242-7 V2 (6GK7242-7KX31-0XE0)",
                  "product_id": "1",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7242-7KX31-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1242-7 V2 (6GK7242-7KX31-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIMATIC CP 1243-1 (6GK7243-1BX30-0XE0)",
                  "product_id": "2",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7243-1BX30-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1243-1 (6GK7243-1BX30-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIMATIC CP 1243-7 LTE EU (6GK7243-7KX30-0XE0)",
                  "product_id": "3",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7243-7KX30-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1243-7 LTE EU (6GK7243-7KX30-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIMATIC CP 1243-7 LTE US (6GK7243-7SX30-0XE0)",
                  "product_id": "4",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7243-7SX30-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1243-7 LTE US (6GK7243-7SX30-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIMATIC CP 1243-8 IRC (6GK7243-8RX30-0XE0)",
                  "product_id": "5",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7243-8RX30-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1243-8 IRC (6GK7243-8RX30-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": ">= V2.0 < V2.2.28",
                "product": {
                  "name": "SIMATIC CP 1542SP-1 IRC (6GK7542-6VX00-0XE0)",
                  "product_id": "6",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7542-6VX00-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1542SP-1 IRC (6GK7542-6VX00-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.0.22",
                "product": {
                  "name": "SIMATIC CP 1543-1 (6GK7543-1AX00-0XE0)",
                  "product_id": "7",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7543-1AX00-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1543-1 (6GK7543-1AX00-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": ">= V2.0 < V2.2.28",
                "product": {
                  "name": "SIMATIC CP 1543SP-1 (6GK7543-6WX00-0XE0)",
                  "product_id": "8",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6GK7543-6WX00-0XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC CP 1543SP-1 (6GK7543-6WX00-0XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": ">= V2.0 < V2.2.28",
                "product": {
                  "name": "SIPLUS ET 200SP CP 1542SP-1 IRC TX RAIL (6AG2542-6VX00-4XE0)",
                  "product_id": "9",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6AG2542-6VX00-4XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIPLUS ET 200SP CP 1542SP-1 IRC TX RAIL (6AG2542-6VX00-4XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": ">= V2.0 < V2.2.28",
                "product": {
                  "name": "SIPLUS ET 200SP CP 1543SP-1 ISEC (6AG1543-6WX00-7XE0)",
                  "product_id": "10",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6AG1543-6WX00-7XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIPLUS ET 200SP CP 1543SP-1 ISEC (6AG1543-6WX00-7XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": ">= V2.0 < V2.2.28",
                "product": {
                  "name": "SIPLUS ET 200SP CP 1543SP-1 ISEC TX RAIL (6AG2543-6WX00-4XE0)",
                  "product_id": "11",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6AG2543-6WX00-4XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIPLUS ET 200SP CP 1543SP-1 ISEC TX RAIL (6AG2543-6WX00-4XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIPLUS NET CP 1242-7 V2 (6AG1242-7KX31-7XE0)",
                  "product_id": "12",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6AG1242-7KX31-7XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIPLUS NET CP 1242-7 V2 (6AG1242-7KX31-7XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.0.22",
                "product": {
                  "name": "SIPLUS NET CP 1543-1 (6AG1543-1AX00-2XE0)",
                  "product_id": "13",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6AG1543-1AX00-2XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIPLUS NET CP 1543-1 (6AG1543-1AX00-2XE0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIPLUS S7-1200 CP 1243-1 (6AG1243-1BX30-2AX0)",
                  "product_id": "14",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6AG1243-1BX30-2AX0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIPLUS S7-1200 CP 1243-1 (6AG1243-1BX30-2AX0)"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "< V3.3.46",
                "product": {
                  "name": "SIPLUS S7-1200 CP 1243-1 RAIL (6AG2243-1BX30-1XE0)",
                  "product_id": "15",
                  "product_identification_helper": {
                    "model_numbers": [
                      "6AG2243-1BX30-1XE0"
                    ]
                  }
                }
              }
            ],
            "category": "product_name",
            "name": "SIPLUS S7-1200 CP 1243-1 RAIL (6AG2243-1BX30-1XE0)"
          }
        ],
        "category": "vendor",
        "name": "Siemens"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-34819",
      "cwe": {
        "id": "CWE-122",
        "name": "Heap-based Buffer Overflow"
      },
      "notes": [
        {
          "category": "summary",
          "text": "The application lacks proper validation of user-supplied data when parsing specific messages. This could result in a heap-based buffer overflow. An attacker could leverage this vulnerability to execute code in the context of device.",
          "title": "Summary"
        }
      ],
      "product_status": {
        "known_affected": [
          "1",
          "2",
          "3",
          "4",
          "5",
          "6",
          "7",
          "8",
          "9",
          "10",
          "11",
          "12",
          "13",
          "14",
          "15"
        ]
      },
      "remediations": [
        {
          "category": "mitigation",
          "details": "Make sure to configure the CP to only connect to trusted SINEMA Remote Connect Server instances",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        },
        {
          "category": "vendor_fix",
          "details": "Update to V2.2.28 or later version",
          "product_ids": [
            "6",
            "8",
            "9",
            "10",
            "11"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109817067/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V3.3.46 or later version",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "12",
            "14",
            "15"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109812218"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V3.0.22 or later version",
          "product_ids": [
            "7",
            "13"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109808678/"
        },
        {
          "category": "workaround",
          "details": "Block access to port 5243/udp e.g. with an external firewall if possible",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        },
        {
          "category": "workaround",
          "details": "Disable the SINEMA Remote Connect Server (SRCS) VPN feature",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "baseScore": 10.0,
            "baseSeverity": "CRITICAL",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C",
            "version": "3.1"
          },
          "products": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        }
      ],
      "title": "CVE-2022-34819"
    },
    {
      "cve": "CVE-2022-34820",
      "cwe": {
        "id": "CWE-77",
        "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')"
      },
      "notes": [
        {
          "category": "summary",
          "text": "The application does not correctly escape some user provided fields during the authentication process. This could allow an attacker to inject custom commands and execute arbitrary code with elevated privileges.",
          "title": "Summary"
        }
      ],
      "product_status": {
        "known_affected": [
          "1",
          "2",
          "3",
          "4",
          "5",
          "6",
          "7",
          "8",
          "9",
          "10",
          "11",
          "12",
          "13",
          "14",
          "15"
        ]
      },
      "remediations": [
        {
          "category": "mitigation",
          "details": "Make sure to configure the CP to only connect to trusted SINEMA Remote Connect Server instances",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        },
        {
          "category": "vendor_fix",
          "details": "Update to V2.2.28 or later version",
          "product_ids": [
            "6",
            "8",
            "9",
            "10",
            "11"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109817067/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V3.3.46 or later version",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "12",
            "14",
            "15"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109812218"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V3.0.22 or later version",
          "product_ids": [
            "7",
            "13"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109808678/"
        },
        {
          "category": "workaround",
          "details": "Block access to port 5243/udp e.g. with an external firewall if possible",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        },
        {
          "category": "workaround",
          "details": "Disable the SINEMA Remote Connect Server (SRCS) VPN feature",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "baseScore": 8.4,
            "baseSeverity": "HIGH",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C",
            "version": "3.1"
          },
          "products": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        }
      ],
      "title": "CVE-2022-34820"
    },
    {
      "cve": "CVE-2022-34821",
      "cwe": {
        "id": "CWE-94",
        "name": "Improper Control of Generation of Code ('Code Injection')"
      },
      "notes": [
        {
          "category": "summary",
          "text": "By injecting code to specific configuration options for OpenVPN, an attacker could execute arbitrary code with elevated privileges.",
          "title": "Summary"
        }
      ],
      "product_status": {
        "known_affected": [
          "1",
          "2",
          "3",
          "4",
          "5",
          "6",
          "7",
          "8",
          "9",
          "10",
          "11",
          "12",
          "13",
          "14",
          "15"
        ]
      },
      "remediations": [
        {
          "category": "mitigation",
          "details": "Make sure to configure the CP to only connect to trusted SINEMA Remote Connect Server instances",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        },
        {
          "category": "vendor_fix",
          "details": "Update to V2.2.28 or later version",
          "product_ids": [
            "6",
            "8",
            "9",
            "10",
            "11"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109817067/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V3.3.46 or later version",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "12",
            "14",
            "15"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109812218"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V3.0.22 or later version",
          "product_ids": [
            "7",
            "13"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109808678/"
        },
        {
          "category": "workaround",
          "details": "Block access to port 5243/udp e.g. with an external firewall if possible",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        },
        {
          "category": "workaround",
          "details": "Disable the SINEMA Remote Connect Server (SRCS) VPN feature",
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "baseScore": 7.6,
            "baseSeverity": "HIGH",
            "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C",
            "version": "3.1"
          },
          "products": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15"
          ]
        }
      ],
      "title": "CVE-2022-34821"
    }
  ]
}