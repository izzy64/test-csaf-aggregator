{
  "document": {
    "category": "csaf_security_advisory",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Disclosure is not limited. (TLPv2: TLP:CLEAR)",
      "tlp": {
        "label": "WHITE"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "summary",
        "text": "Multiple vulnerabilities were found in SIMATIC WinCC that ultimately could allow local or remote attackers to escalate privileges and read, write or delete critical files.\n\nSiemens has released updates for several affected products and recommends to update to the latest versions. Siemens recommends specific countermeasures for products where updates are not, or not yet available.\n\nNote: The vulnerability CVE-2021-40359 is part of a shared component, used by various Siemens products (SIMATIC Communication Services - SCS). The installation of a fix version of any product also removes the vulnerability for other products on the same system, even if those products were not updated.",
        "title": "Summary"
      },
      {
        "category": "general",
        "text": "As a general security measure, Siemens strongly recommends to protect network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends to configure the environment according to Siemens' operational guidelines for Industrial Security (Download: \nhttps://www.siemens.com/cert/operational-guidelines-industrial-security), and to follow the recommendations in the product manuals.\nAdditional information on Industrial Security by Siemens can be found at: https://www.siemens.com/industrialsecurity",
        "title": "General Recommendations"
      },
      {
        "category": "general",
        "text": "For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the Siemens ProductCERT: https://www.siemens.com/cert/advisories",
        "title": "Additional Resources"
      },
      {
        "category": "legal_disclaimer",
        "text": "Siemens Security Advisories are subject to the terms and conditions contained in Siemens' underlying license terms or other applicable agreements previously agreed to with Siemens (hereinafter \"License Terms\"). To the extent applicable to information, software or documentation made available in or through a Siemens Security Advisory, the Terms of Use of Siemens' Global Website (https://www.siemens.com/terms_of_use, hereinafter \"Terms of Use\"), in particular Sections 8-10 of the Terms of Use, shall apply additionally. In case of conflicts, the License Terms shall prevail over the Terms of Use.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "productcert@siemens.com",
      "name": "Siemens ProductCERT",
      "namespace": "https://www.siemens.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "SSA-840188: Multiple Vulnerabilities in SIMATIC WinCC Affecting Other SIMATIC Software Products - HTML Version",
        "url": "https://cert-portal.siemens.com/productcert/html/ssa-840188.html"
      },
      {
        "category": "self",
        "summary": "SSA-840188: Multiple Vulnerabilities in SIMATIC WinCC Affecting Other SIMATIC Software Products - CSAF Version",
        "url": "https://cert-portal.siemens.com/productcert/csaf/ssa-840188.json"
      },
      {
        "category": "self",
        "summary": "SSA-840188: Multiple Vulnerabilities in SIMATIC WinCC Affecting Other SIMATIC Software Products - PDF Version",
        "url": "https://cert-portal.siemens.com/productcert/pdf/ssa-840188.pdf"
      },
      {
        "category": "self",
        "summary": "SSA-840188: Multiple Vulnerabilities in SIMATIC WinCC Affecting Other SIMATIC Software Products - TXT Version",
        "url": "https://cert-portal.siemens.com/productcert/txt/ssa-840188.txt"
      }
    ],
    "title": "SSA-840188: Multiple Vulnerabilities in SIMATIC WinCC Affecting Other SIMATIC Software Products",
    "tracking": {
      "current_release_date": "2023-04-11T00:00:00Z",
      "generator": {
        "engine": {
          "name": "Siemens ProductCERT CSAF Generator",
          "version": "1"
        }
      },
      "id": "SSA-840188",
      "initial_release_date": "2021-11-09T00:00:00Z",
      "revision_history": [
        {
          "date": "2021-11-09T00:00:00Z",
          "legacy_version": "1.0",
          "number": "1",
          "summary": "Publication Date"
        },
        {
          "date": "2022-02-08T00:00:00Z",
          "legacy_version": "1.1",
          "number": "2",
          "summary": "Added solution for SIMATIC WinCC V16 and V17 and adjusted solution for SIMATIC PCS 7 V9.1"
        },
        {
          "date": "2022-03-08T00:00:00Z",
          "legacy_version": "1.2",
          "number": "3",
          "summary": "Added Mitigation to CVE-2021-40358"
        },
        {
          "date": "2022-04-12T00:00:00Z",
          "legacy_version": "1.3",
          "number": "4",
          "summary": "Added solution for SIMATIC WinCC V7.4; added solution for SIMATIC PCS 7 V8.2 and SIMATIC PCS 7 V9.0 and related components; added SIMATIC NET PC Software incl. solution for V17; added a note regarding shared components"
        },
        {
          "date": "2022-05-10T00:00:00Z",
          "legacy_version": "1.4",
          "number": "5",
          "summary": "Added solution for SIMATIC WinCC V15"
        },
        {
          "date": "2022-07-12T00:00:00Z",
          "legacy_version": "1.5",
          "number": "6",
          "summary": "Added fix for SIMATIC NET PC Software V16"
        },
        {
          "date": "2023-04-11T00:00:00Z",
          "legacy_version": "1.6",
          "number": "7",
          "summary": "No fix planned for OpenPCS 7 V8.2, for SIMATIC BATCH V8.2 and V9.0 and for SIMATIC Route Control V8.2 and V9.0"
        }
      ],
      "status": "final",
      "version": "7"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "OpenPCS 7 V8.2",
                  "product_id": "1"
                }
              }
            ],
            "category": "product_name",
            "name": "OpenPCS 7 V8.2"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V9.0 Upd4",
                "product": {
                  "name": "OpenPCS 7 V9.0",
                  "product_id": "2"
                }
              }
            ],
            "category": "product_name",
            "name": "OpenPCS 7 V9.0"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "OpenPCS 7 V9.1",
                  "product_id": "3"
                }
              }
            ],
            "category": "product_name",
            "name": "OpenPCS 7 V9.1"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC BATCH V8.2",
                  "product_id": "4"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC BATCH V8.2"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC BATCH V9.0",
                  "product_id": "5"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC BATCH V9.0"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC BATCH V9.1",
                  "product_id": "6"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC BATCH V9.1"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC NET PC Software V14",
                  "product_id": "7"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC NET PC Software V14"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC NET PC Software V15",
                  "product_id": "8"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC NET PC Software V15"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V16 Update 6",
                "product": {
                  "name": "SIMATIC NET PC Software V16",
                  "product_id": "9"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC NET PC Software V16"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V17 SP1",
                "product": {
                  "name": "SIMATIC NET PC Software V17",
                  "product_id": "10"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC NET PC Software V17"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC PCS 7 V8.2",
                  "product_id": "11"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC PCS 7 V8.2"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V9.0 SP3 UC04",
                "product": {
                  "name": "SIMATIC PCS 7 V9.0",
                  "product_id": "12"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC PCS 7 V9.0"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V9.1 SP1",
                "product": {
                  "name": "SIMATIC PCS 7 V9.1",
                  "product_id": "13"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC PCS 7 V9.1"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC Route Control V8.2",
                  "product_id": "14"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC Route Control V8.2"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC Route Control V9.0",
                  "product_id": "15"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC Route Control V9.0"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "vers:all/*",
                "product": {
                  "name": "SIMATIC Route Control V9.1",
                  "product_id": "16"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC Route Control V9.1"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V15 SP1 Update 7",
                "product": {
                  "name": "SIMATIC WinCC V15 and earlier",
                  "product_id": "17"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC WinCC V15 and earlier"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V16 Update 5",
                "product": {
                  "name": "SIMATIC WinCC V16",
                  "product_id": "18"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC WinCC V16"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V17 Update 2",
                "product": {
                  "name": "SIMATIC WinCC V17",
                  "product_id": "19"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC WinCC V17"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V7.4 SP1 Update 19",
                "product": {
                  "name": "SIMATIC WinCC V7.4",
                  "product_id": "20"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC WinCC V7.4"
          },
          {
            "branches": [
              {
                "category": "product_version_range",
                "name": "All versions < V7.5 SP2 Update 5",
                "product": {
                  "name": "SIMATIC WinCC V7.5",
                  "product_id": "21"
                }
              }
            ],
            "category": "product_name",
            "name": "SIMATIC WinCC V7.5"
          }
        ],
        "category": "vendor",
        "name": "Siemens"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-40358",
      "cwe": {
        "id": "CWE-22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
      },
      "notes": [
        {
          "category": "summary",
          "text": "Legitimate file operations on the web server of the affected systems do not properly neutralize special elements within the pathname. An attacker could then cause the pathname to resolve to a location outside of the restricted directory on the server and read, write or delete unexpected critical files.",
          "title": "Summary"
        }
      ],
      "product_status": {
        "known_affected": [
          "11",
          "12",
          "13",
          "17",
          "18",
          "19",
          "20",
          "21"
        ]
      },
      "remediations": [
        {
          "category": "mitigation",
          "details": "CVE-2021-40358: Disable the webserver or only enable it temporarily, when needed",
          "product_ids": [
            "11",
            "12",
            "13",
            "17",
            "18",
            "19",
            "20",
            "21"
          ]
        },
        {
          "category": "mitigation",
          "details": "To fix CVE-2021-40359 see chapter \"Additional Information\"",
          "product_ids": [
            "11",
            "12"
          ]
        },
        {
          "category": "vendor_fix",
          "details": "Update to V8.2 SP1; then update SIMATIC WinCC to V7.4 SP1 Update 19 or later version to fix CVE-2021-40358 and CVE-2021-40364",
          "product_ids": [
            "11"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109806846/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V15 SP1 Update 7 or later version",
          "product_ids": [
            "17"
          ],
          "url": "https://support.industry.siemens.com/cs/us/en/view/109763890/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V16 Update 5 or later version",
          "product_ids": [
            "18"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109776017/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V17 Update 2 or later version",
          "product_ids": [
            "19"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109784441/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V7.4 SP1 Update 19 or later version",
          "product_ids": [
            "20"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109806846/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V7.5 SP2 Update 5 or later version",
          "product_ids": [
            "21"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793460/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V9.1 SP1 or later version",
          "product_ids": [
            "13"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109805073/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V9.0 SP3 UC04 or later version to fix CVE-2021-40358 and CVE-2021-40364",
          "product_ids": [
            "12"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109780528/"
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "baseScore": 9.9,
            "baseSeverity": "CRITICAL",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C",
            "version": "3.1"
          },
          "products": [
            "11",
            "12",
            "13",
            "17",
            "18",
            "19",
            "20",
            "21"
          ]
        }
      ],
      "title": "CVE-2021-40358"
    },
    {
      "cve": "CVE-2021-40359",
      "cwe": {
        "id": "CWE-22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
      },
      "notes": [
        {
          "category": "summary",
          "text": "When downloading files, the affected systems do not properly neutralize special elements within the pathname. An attacker could then cause the pathname to resolve to a location outside of the restricted directory on the server and read unexpected critical files.",
          "title": "Summary"
        }
      ],
      "product_status": {
        "known_affected": [
          "1",
          "2",
          "3",
          "4",
          "5",
          "6",
          "7",
          "8",
          "9",
          "10",
          "11",
          "12",
          "13",
          "14",
          "15",
          "16",
          "17",
          "18",
          "19",
          "20",
          "21"
        ]
      },
      "remediations": [
        {
          "category": "mitigation",
          "details": "The vulnerability is fixed if SIMATIC WinCC V7.4 SP1 Update 19 or later version is installed on the same system",
          "product_ids": [
            "1",
            "4",
            "5",
            "14",
            "15"
          ]
        },
        {
          "category": "mitigation",
          "details": "To fix CVE-2021-40359 see chapter \"Additional Information\"",
          "product_ids": [
            "11",
            "12"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Currently no fix is planned",
          "product_ids": [
            "1",
            "4",
            "5",
            "7",
            "8",
            "14",
            "15"
          ]
        },
        {
          "category": "vendor_fix",
          "details": "Update to V8.2 SP1; then update SIMATIC WinCC to V7.4 SP1 Update 19 or later version to fix CVE-2021-40358 and CVE-2021-40364",
          "product_ids": [
            "11"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109806846/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V15 SP1 Update 7 or later version",
          "product_ids": [
            "17"
          ],
          "url": "https://support.industry.siemens.com/cs/us/en/view/109763890/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V16 Update 5 or later version",
          "product_ids": [
            "18"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109776017/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V17 Update 2 or later version",
          "product_ids": [
            "19"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109784441/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V7.4 SP1 Update 19 or later version",
          "product_ids": [
            "20"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109806846/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V7.5 SP2 Update 5 or later version",
          "product_ids": [
            "21"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793460/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V9.1 SP1 or later version",
          "product_ids": [
            "13"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109805073/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V9.0 SP3 UC04 or later version to fix CVE-2021-40358 and CVE-2021-40364",
          "product_ids": [
            "12"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109780528/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V9.0 Upd4 or later version; V9.0 Upd4 is bundled in PCS 7 V9.0 SP3 UC04",
          "product_ids": [
            "2"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109780528/"
        },
        {
          "category": "vendor_fix",
          "details": "See remediation for SIMATIC PCS 7 V9.1",
          "product_ids": [
            "3",
            "6",
            "16"
          ]
        },
        {
          "category": "vendor_fix",
          "details": "Update to V16 Update 6 or later version",
          "product_ids": [
            "9"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109811815/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V17 SP1 or later version",
          "product_ids": [
            "10"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/de/view/109808270/"
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "baseScore": 7.7,
            "baseSeverity": "HIGH",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C",
            "version": "3.1"
          },
          "products": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20",
            "21"
          ]
        }
      ],
      "title": "CVE-2021-40359"
    },
    {
      "cve": "CVE-2021-40364",
      "cwe": {
        "id": "CWE-532",
        "name": "Insertion of Sensitive Information into Log File"
      },
      "notes": [
        {
          "category": "summary",
          "text": "The affected systems store sensitive information in log files. An attacker with access to the log files could publicly expose the information or reuse it to develop further attacks on the system.",
          "title": "Summary"
        }
      ],
      "product_status": {
        "known_affected": [
          "11",
          "12",
          "13",
          "17",
          "18",
          "19",
          "20",
          "21"
        ]
      },
      "remediations": [
        {
          "category": "mitigation",
          "details": "CVE-2021-40364: Harden the application\u2019s host to prevent local access by untrusted personnel",
          "product_ids": [
            "11",
            "12",
            "13",
            "17",
            "18",
            "19",
            "20",
            "21"
          ]
        },
        {
          "category": "mitigation",
          "details": "To fix CVE-2021-40359 see chapter \"Additional Information\"",
          "product_ids": [
            "11",
            "12"
          ]
        },
        {
          "category": "vendor_fix",
          "details": "Update to V8.2 SP1; then update SIMATIC WinCC to V7.4 SP1 Update 19 or later version to fix CVE-2021-40358 and CVE-2021-40364",
          "product_ids": [
            "11"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109806846/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V15 SP1 Update 7 or later version",
          "product_ids": [
            "17"
          ],
          "url": "https://support.industry.siemens.com/cs/us/en/view/109763890/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V16 Update 5 or later version",
          "product_ids": [
            "18"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109776017/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V17 Update 2 or later version",
          "product_ids": [
            "19"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109784441/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V7.4 SP1 Update 19 or later version",
          "product_ids": [
            "20"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109806846/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V7.5 SP2 Update 5 or later version",
          "product_ids": [
            "21"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793460/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V9.1 SP1 or later version",
          "product_ids": [
            "13"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109805073/"
        },
        {
          "category": "vendor_fix",
          "details": "Update to V9.0 SP3 UC04 or later version to fix CVE-2021-40358 and CVE-2021-40364",
          "product_ids": [
            "12"
          ],
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109780528/"
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C",
            "version": "3.1"
          },
          "products": [
            "11",
            "12",
            "13",
            "17",
            "18",
            "19",
            "20",
            "21"
          ]
        }
      ],
      "title": "CVE-2021-40364"
    }
  ]
}