{
  "document": {
    "title": "SSA-646763: DNSpooq - Dnsmasq Vulnerabilities in SCALANCE and RUGGEDCOM Devices",
    "category": "Siemens Security Advisory",
    "csaf_version": "2.0",
    "publisher": {
      "name": "Siemens ProductCERT",
      "contact_details": "productcert@siemens.com",
      "category": "vendor",
      "namespace": "https://www.siemens.com"
    },
    "distribution": {
      "text": "Disclosure is not limited.",
      "tlp": {
        "label": "WHITE"
      }
    },
    "tracking": {
      "id": "SSA-646763",
      "status": "final",
      "version": "4",
      "revision_history": [
        {
          "number": "1",
          "legacy_version": "1.0",
          "date": "2021-01-19T00:00:00Z",
          "summary": "Publication Date"
        },
        {
          "number": "2",
          "legacy_version": "1.1",
          "date": "2021-03-09T00:00:00Z",
          "summary": "Added solution for SCALANCE SC-600"
        },
        {
          "number": "3",
          "legacy_version": "1.2",
          "date": "2021-04-13T00:00:00Z",
          "summary": "Added solution for SCALANCE M-800/S615 and RUGGEDCOM RM1224"
        },
        {
          "number": "4",
          "legacy_version": "1.3",
          "date": "2021-05-11T00:00:00Z",
          "summary": "Clarified that a solution for SCALANCE W1750D is not expected"
        }
      ],
      "initial_release_date": "2021-01-19T00:00:00Z",
      "current_release_date": "2021-05-11T00:00:00Z",
      "generator": {
        "engine": {
          "name": "Siemens ProductCERT CSAF Generator",
          "version": "1"
        }
      }
    },
    "notes": [
      {
        "title": "Summary",
        "category": "summary",
        "text": "Security researchers discovered and disclosed seven vulnerabilities in the open-source DNS component \"dnsmasq\", also known as \"DNSpooq\" vulnerabilities (CVE-2020-25681 through CVE-2020-25687). Three vulnerabilities (CVE-2020-25684 through CVE-2020-25686) affect the validation of DNS responses and impact several SCALANCE and RUGGEDCOM devices as listed below.\n\nSiemens has released updates for several affected products and recommends to update to the latest versions. Siemens recommends specific countermeasures for products where updates are not available."
      },
      {
        "title": "General Recommendations",
        "category": "general",
        "text": "As a general security measure, Siemens strongly recommends to protect network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends to configure the environment according to Siemens' operational guidelines for Industrial Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to follow the recommendations in the product manuals.\n\nAdditional information on Industrial Security by Siemens can be found at: https://www.siemens.com/industrialsecurity"
      },
      {
        "title": "Additional Resources",
        "category": "general",
        "text": "For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the Siemens ProductCERT: https://www.siemens.com/cert/advisories"
      },
      {
        "title": "Terms of Use",
        "category": "legal_disclaimer",
        "text": "Siemens Security Advisories are subject to the terms and conditions contained in Siemens' underlying license terms or other applicable agreements previously agreed to with Siemens (hereinafter \"License Terms\"). To the extent applicable to information, software or documentation made available in or through a Siemens Security Advisory, the Terms of Use of Siemens' Global Website (https://www.siemens.com/terms_of_use, hereinafter \"Terms of Use\"), in particular Sections 8-10 of the Terms of Use, shall apply additionally. In case of conflicts, the License Terms shall prevail over the Terms of Use."
      }
    ],
    "references": [
      {
        "category": "self",
        "url": "https://cert-portal.siemens.com/productcert/pdf/ssa-646763.pdf",
        "summary": "SSA-646763: DNSpooq - Dnsmasq Vulnerabilities in SCALANCE and RUGGEDCOM Devices - PDF Version"
      },
      {
        "category": "self",
        "url": "https://cert-portal.siemens.com/productcert/txt/ssa-646763.txt",
        "summary": "SSA-646763: DNSpooq - Dnsmasq Vulnerabilities in SCALANCE and RUGGEDCOM Devices - TXT Version"
      },
      {
        "category": "self",
        "url": "https://cert-portal.siemens.com/productcert/csaf/ssa-646763.json",
        "summary": "SSA-646763: DNSpooq - Dnsmasq Vulnerabilities in SCALANCE and RUGGEDCOM Devices - CSAF Version"
      }
    ],
    "acknowledgments": [
      {
        "names": [
          "Moshe Kol",
          "Shlomi Oberman"
        ],
        "organization": "JSOF",
        "summary": "coordinated disclosure"
      },
      {
        "organization": "CERT Coordination Center (CERT/CC)",
        "summary": "coordination efforts"
      },
      {
        "organization": "Industrial Control System Cyber Emergency Response Team (ICS-CERT)",
        "summary": "coordination efforts"
      }
    ]
  },
  "product_tree": {
    "branches": [
      {
        "name": "Siemens",
        "category": "vendor",
        "branches": [
          {
            "name": "RUGGEDCOM RM1224",
            "category": "product_name",
            "branches": [
              {
                "name": "< V6.4",
                "category": "product_version_range",
                "product": {
                  "product_id": "1",
                  "name": "RUGGEDCOM RM1224"
                }
              }
            ]
          },
          {
            "name": "SCALANCE M-800",
            "category": "product_name",
            "branches": [
              {
                "name": "< V6.4",
                "category": "product_version_range",
                "product": {
                  "product_id": "2",
                  "name": "SCALANCE M-800"
                }
              }
            ]
          },
          {
            "name": "SCALANCE S615",
            "category": "product_name",
            "branches": [
              {
                "name": "< V6.4",
                "category": "product_version_range",
                "product": {
                  "product_id": "3",
                  "name": "SCALANCE S615"
                }
              }
            ]
          },
          {
            "name": "SCALANCE SC-600",
            "category": "product_name",
            "branches": [
              {
                "name": "< V2.1.3",
                "category": "product_version_range",
                "product": {
                  "product_id": "4",
                  "name": "SCALANCE SC-600"
                }
              }
            ]
          },
          {
            "name": "SCALANCE W1750D",
            "category": "product_name",
            "branches": [
              {
                "name": "vers:all/*",
                "category": "product_version_range",
                "product": {
                  "product_id": "5",
                  "name": "SCALANCE W1750D"
                }
              }
            ]
          }
        ]
      }
    ]
  },
  "vulnerabilities": [
    {
      "title": "CVE-2020-25684",
      "notes": [
        {
          "title": "Summary",
          "category": "summary",
          "text": "Affected devices lack proper address/port check in the DNS reply_query function of dnsmasq.\n\nThis could make it easier for remote off-path attackers to forge replies."
        }
      ],
      "cve": "CVE-2020-25684",
      "cwe": {
        "id": "CWE-290",
        "name": "Authentication Bypass by Spoofing"
      },
      "product_status": {
        "known_affected": [
          "1",
          "2",
          "3",
          "4",
          "5"
        ]
      },
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "baseScore": 4.0,
            "baseSeverity": "MEDIUM",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N/E:P/RL:U/RC:C"
          },
          "products": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ]
        }
      ],
      "remediations": [
        {
          "product_ids": [
            "1",
            "2",
            "3"
          ],
          "category": "vendor_fix",
          "details": "Update to V6.4 or later version",
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/"
        },
        {
          "product_ids": [
            "4"
          ],
          "category": "vendor_fix",
          "details": "Update to V2.1.3 or later version",
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793041/"
        },
        {
          "product_ids": [
            "5"
          ],
          "category": "none_available",
          "details": "Currently no remediation is available"
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE M-800: Disable DNS proxy in the device configuration (System - DNS - DNS Proxy - Disable Checkbox „Enable DNS Proxy“), and configure the connected devices in the internal network to use a different DNS server. Note that the DNS proxy is enabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "RUGGEDCOM RM1224: Same as for SCALANCE M-800. Note that the DNS proxy is enabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE S615: Same as for SCALANCE M-800. Note that the DNS proxy is disabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE SC-600: Same as for SCALANCE M-800. Note that the DNS proxy is disabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE W1750D: If “OpenDNS”, “Captive Portal” or “URL redirection” functionality is not used, deploy firewall rules in the device configuration to block incoming access to port 53/UDP"
        }
      ],
      "references": [
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25684 - RUGGEDCOM RM1224"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25684 - SCALANCE M-800"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25684 - SCALANCE S615"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793041/",
          "summary": "CVE-2020-25684 - SCALANCE SC-600"
        },
        {
          "url": "https://cert-portal.siemens.com/productcert/mitre/CVE-2020-25684.json",
          "summary": "CVE-2020-25684 Mitre 5.0 json"
        }
      ]
    },
    {
      "title": "CVE-2020-25685",
      "notes": [
        {
          "title": "Summary",
          "category": "summary",
          "text": "Affected devices lack query resource name (RRNAME) checks in the DNS reply_query function of dnsmasq.\n\nThis could allow a remote attacker to spoof DNS traffic that can lead to DNS cache poisoning."
        }
      ],
      "cve": "CVE-2020-25685",
      "cwe": {
        "id": "CWE-290",
        "name": "Authentication Bypass by Spoofing"
      },
      "product_status": {
        "known_affected": [
          "1",
          "2",
          "3",
          "4",
          "5"
        ]
      },
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "baseScore": 4.0,
            "baseSeverity": "MEDIUM",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N/E:P/RL:U/RC:C"
          },
          "products": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ]
        }
      ],
      "remediations": [
        {
          "product_ids": [
            "1",
            "2",
            "3"
          ],
          "category": "vendor_fix",
          "details": "Update to V6.4 or later version",
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/"
        },
        {
          "product_ids": [
            "4"
          ],
          "category": "vendor_fix",
          "details": "Update to V2.1.3 or later version",
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793041/"
        },
        {
          "product_ids": [
            "5"
          ],
          "category": "none_available",
          "details": "Currently no remediation is available"
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE M-800: Disable DNS proxy in the device configuration (System - DNS - DNS Proxy - Disable Checkbox „Enable DNS Proxy“), and configure the connected devices in the internal network to use a different DNS server. Note that the DNS proxy is enabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "RUGGEDCOM RM1224: Same as for SCALANCE M-800. Note that the DNS proxy is enabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE S615: Same as for SCALANCE M-800. Note that the DNS proxy is disabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE SC-600: Same as for SCALANCE M-800. Note that the DNS proxy is disabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE W1750D: If “OpenDNS”, “Captive Portal” or “URL redirection” functionality is not used, deploy firewall rules in the device configuration to block incoming access to port 53/UDP"
        }
      ],
      "references": [
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25685 - RUGGEDCOM RM1224"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25685 - SCALANCE M-800"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25685 - SCALANCE S615"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793041/",
          "summary": "CVE-2020-25685 - SCALANCE SC-600"
        },
        {
          "url": "https://cert-portal.siemens.com/productcert/mitre/CVE-2020-25685.json",
          "summary": "CVE-2020-25685 Mitre 5.0 json"
        }
      ]
    },
    {
      "title": "CVE-2020-25686",
      "notes": [
        {
          "title": "Summary",
          "category": "summary",
          "text": "Affected devices lack sufficient entropy in dnsmasq to handle multiple DNS query requests from the same resource name (RRNAME).\n\nThis could allow a remote attacker to spoof DNS traffic, using a birthday attack (RFC 5452), than can lead to DNS cache poisoning."
        }
      ],
      "cve": "CVE-2020-25686",
      "cwe": {
        "id": "CWE-330",
        "name": "Use of Insufficiently Random Values"
      },
      "product_status": {
        "known_affected": [
          "1",
          "2",
          "3",
          "4",
          "5"
        ]
      },
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "baseScore": 4.0,
            "baseSeverity": "MEDIUM",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N/E:P/RL:U/RC:C"
          },
          "products": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ]
        }
      ],
      "remediations": [
        {
          "product_ids": [
            "1",
            "2",
            "3"
          ],
          "category": "vendor_fix",
          "details": "Update to V6.4 or later version",
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/"
        },
        {
          "product_ids": [
            "4"
          ],
          "category": "vendor_fix",
          "details": "Update to V2.1.3 or later version",
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793041/"
        },
        {
          "product_ids": [
            "5"
          ],
          "category": "none_available",
          "details": "Currently no remediation is available"
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE M-800: Disable DNS proxy in the device configuration (System - DNS - DNS Proxy - Disable Checkbox „Enable DNS Proxy“), and configure the connected devices in the internal network to use a different DNS server. Note that the DNS proxy is enabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "RUGGEDCOM RM1224: Same as for SCALANCE M-800. Note that the DNS proxy is enabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE S615: Same as for SCALANCE M-800. Note that the DNS proxy is disabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE SC-600: Same as for SCALANCE M-800. Note that the DNS proxy is disabled by default."
        },
        {
          "product_ids": [
            "1",
            "2",
            "3",
            "4",
            "5"
          ],
          "category": "mitigation",
          "details": "SCALANCE W1750D: If “OpenDNS”, “Captive Portal” or “URL redirection” functionality is not used, deploy firewall rules in the device configuration to block incoming access to port 53/UDP"
        }
      ],
      "references": [
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25686 - RUGGEDCOM RM1224"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25686 - SCALANCE M-800"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109794349/",
          "summary": "CVE-2020-25686 - SCALANCE S615"
        },
        {
          "url": "https://support.industry.siemens.com/cs/ww/en/view/109793041/",
          "summary": "CVE-2020-25686 - SCALANCE SC-600"
        },
        {
          "url": "https://cert-portal.siemens.com/productcert/mitre/CVE-2020-25686.json",
          "summary": "CVE-2020-25686 Mitre 5.0 json"
        }
      ]
    }
  ]
}

